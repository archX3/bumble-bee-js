var Barge=Bee||{};
(function(k,e){"function"===typeof define&&define.amd?define([],function(){return k.TabbedView=e(k)}):"object"===typeof exports?module.exports=e(k):k.TabbedView=e(k)})(window,function(k){function e(a,b,c){this.parent=a;this.INDEX=0;this.tabHeadNames=b;this.list=this.panesHost=this.tabsHost=null;this.tabs=[];this.panes=[];this.sortable=this.activePane=this.activeTab=this.showTabsList=this.addButton=null;this.options={defaultActiveTabNumber:1,closeButtons:!1,tabHeadLocation:"top",sortHeads:!1,icons:!1,
keepState:!0,keepSortHeadsState:!0,tabbedViewID:null,canAddTab:!1,addButtonCallback:null,canRemoveTab:!1,maxNumberOfTabs:9,genericTabName:"Untitled Tab",autoCreate:!0,scrollablePanes:!1};c&&(this.options=g.extend(this.options,c));!0===this.options.autoCreate&&this.create()}Bee.Dom=Bee.Dom||{};var g=Bee.utils,l=Bee.String,h=Bee.Dom,m=Bee.Object,n=new Bee.Event.EventManager;e.prototype.create=function(){var a=h.createEl("div",{className:"tabbedView"},this.options.style);a.appendChild(this._renderTabHeads(this.tabHeadNames));
a.appendChild(this._renderPanes(this.tabHeadNames));this.parent&&(g.isString(this.parent)&&(this.parent=h.getEl(this.parent)),h.insertChildAt(this.parent,a,this.INDEX));document.querySelectorAll(".tabbedView .tabHead");this._addClickEvent();!0===this.options.keepState&&g.defined(this.options.tabbedViewID)&&!l.isEmpty(this.options.tabbedViewID)&&(a=localStorage.getItem(this.options.tabbedViewID),a=h.getElementsByAttribute("data-pane",a,!0),g.defined(a)&&g.defined(a.click)&&a.click())};e.prototype._addClickEvent=
function(){var a=this;n.bind(this.list,"click",function(b){var c=b.target;if(c.classList.contains("tabCloseBtn"))a.closeTab(c);else{var d=Bee.utils.gebi(c.getAttribute("data-pane").toString());document.querySelector(".activePane");a._setActive(c,"tabHead","activeTabHead");a.activeTab=c;a._setActive(d,"pane","activePane");a.activePane=d;!0===a.options.keepState&&localStorage.setItem(a.options.tabbedViewID,c.getAttribute("data-pane").toString())}b.stopPropagation()})};e.prototype._createSorter=function(){g.defined(k.DragSorter)&&
(this.sortable=null,this.sortable=new DragSorter(this.list,{group:"",animation:200,delay:0,chosenClass:"chosenSortItem",store:!0===this.options.keepSortHeadsState?{get:function(a){return(a=localStorage.getItem("tv"+a.options.group))?a.split("|"):[]},set:function(a){var b=a.toArray();localStorage.setItem("tv"+a.options.group,b.join("|"))}}:null}))};e.prototype.createTab=function(a,b,c,d,f){b=void 0===b?null:b;f=void 0===f?null:f;c=h.createEl("li",{className:((void 0===d?0:d)?"addButton":"tabHead")+
(void 0===c?"":c)},{userSelect:"none",paddingRight:this.options.canRemoveTab?"3px":"10px"});c.setAttribute("data-pane","pane"+g.pInt(a+1));c.setAttribute("data-count",a+1);d=h.createEl("a",{href:"#",innerHTML:b?b:this.options.genericTabName},{userSelect:"none",pointerEvents:"none"});g.defined(f)&&(f=h.createEl("span",{className:"tabIcon tabIco"},g.defined(f.style)?f.style:null),c.appendChild(f));c.appendChild(d);this.options.canRemoveTab&&(f=h.createEl("span",{className:"tabCloseBtn",innerHTML:"&times;"},
{marginLeft:"10px"}),c.appendChild(f));this.tabs.push({el:c,tabName:b,index:a});this.list.appendChild(c)};e.prototype._renderTabHeads=function(){function a(a){var b=h.createEl("li",{className:"addButton"},{userSelect:"none",padding:"2px",fontWeight:600,lineHeight:1,minWidth:"19px",textAlign:"center"});a=h.createEl("span",{href:"#",innerHTML:a},{userSelect:"none"});b.appendChild(a);return b}var b=this;this.tabsHost=h.createEl("div",{className:"tabHeads"});this.list=h.createEl("ul",{id:"tHeadsUl"});
if(g.isArray(b.tabHeadNames))g.forEach(b.tabHeadNames,function(a,c){b.createTab(c,b.tabHeadNames[c],c===b.options.defaultActiveTabNumber-1?" activeTabHead":"")});else if(g.isObject(b.tabHeadNames)){var c=0;m.forEach(b.tabHeadNames,function(a){c++;var d=g.defined(a.activeTab)&&!0===a.activeTab?" activeTabHead":"";b.createTab(c,a.tabName,d,!1,g.defined(a.icon)?a.icon:null)})}this.tabsHost.appendChild(this.list);!0===this.options.sortHeads&&this._createSorter();if(!0===b.options.canAddTab||!0===b.options.showTabsList){var d=
h.createEl("ul"),f=null;!0===b.options.canAddTab&&(f=a("+"),d.appendChild(f),b.addButton=f,n.bind(b.addButton,"click",function(a){b.addTab(b.options.genericTabName+" "+(b.list.children.length+1));null!==b.options.addButtonCallback&&b.options.addButtonCallback()}));!0===b.options.showTabsList&&(f=a("&equiv;"),d.appendChild(f),b.showTabsList=f);f=null;b.tabsHost.appendChild(d)}return this.tabsHost};e.prototype.createPane=function(a,b,c,d,f,e){c=void 0===c?!1:c;d=void 0===d?"Untitled Tab ":d;f=void 0===
f?{}:f;e=void 0===e?null:e;a=h.createEl("div",{className:"pane"+(void 0===a?"":a),id:"pane"+g.pInt(b+1)},f);!0===this.options.scrollablePanes&&h.css(a,{overflowY:"auto"});(c=c?document.getElementById(c):e?e:null)&&a.appendChild(c);this.panes.push({el:a,tabName:d,index:b});this.panesHost.appendChild(a)};e.prototype._renderPanes=function(){var a=this;this.panesHost=h.createEl("div",{className:"panes"},g.defined(a.options.panesHostStyle)?a.options.panesHostStyle:null);if(g.isArray(a.tabHeadNames))g.forEach(a.tabHeadNames,
function(b,d){b=h.createEl("div",{className:"pane"+(d===a.options.defaultActiveTabNumber-1?" activePane":""),id:"pane"+g.pInt(d+1)});(d=document.getElementById(l.toPascalCase(a.tabHeadNames[d],!0)))&&b.appendChild(d);a.panes.push(b);a.panesHost.appendChild(b)});else if(g.isObject(a.tabHeadNames)){var b=0;m.forEach(a.tabHeadNames,function(c){b++;var d=g.defined(c.activeTab)&&!0===c.activeTab?" activePane":"";a.createPane(d,b,c.containerID,c.tabName,g.defined(c.style)?c.style:{})})}return this.panesHost};
e.prototype._setActive=function(a,b,c){if(a&&!a.classList.contains(c)){var d=a.parentNode;d=d.children;for(var f=0,e=d.length;f<e;f++)d[f].className=b;a.className=c;"tabHead"===b?this.activeTab=a:"pane"===b&&(this.activePane=a)}};e.prototype.addTab=function(a){if(this.list.children.length<this.options.maxNumberOfTabs){var b=this.tabs.length+1;this.createTab(b,a,"");this.createPane("",b,!1,a);this.list.children[this.list.children.length-1].click()}};e.prototype.closeTab=function(a){var b=Bee.utils.gebi(a.parentElement.getAttribute("data-pane").toString());
if(a.parentElement.classList.contains("activeTabHead")&&1<this.list.children.length){var c=h.indexOf(this.list,a.parentElement);0===c?this.list.children[1].click():this.list.children[c-1].click()}h.closeWin(a.parentElement,!0);h.closeWin(b,!0)};e.prototype.getActiveTabHead=function(){};e.prototype.getActivePane=function(){return this.activePane};e.prototype.getActiveTab=function(){return this.activeTab};e.prototype.setTabName=function(a){};e.prototype.destroy=function(){};return e});
